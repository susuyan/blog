---
title: "协议"
date: "2019-12-16"
permalink: "2019-12-16-protocols"
---

# 协议

在 Swift 里，一个协议表示一组正式提出的要求 (requirements)。例如，Equatable 协议要求 实现的类型提供 == 操作符。

## 主要特性

- 协议可以自行扩展新的功能

最简单的例子就是 Equatable，它要求实现的类型提供 == 操作 符。

- 协议可以通过条件化扩展 (conditional extensions) 添加需要额外约束的 API

  例如，在 Collection 协议中，只有 Element 实现了 Comparable 的时候，才提供了 max() 方法

- 协议可以继承其它协议

例如，Hashable 要求实现的类型必须同时实现 Equatable 协议。

- 协议还可以被组合起来形成新的协议

标准库中的 Codable 就是 Encodable 和 Decodable 协议组合之后的别名。

- 协议还可以声明关联类型，实现了这个协议的类型就需要定义关联类型对应的具体类型

> 每一个协议都会引入一层额外的抽象， 有时，这会增加理解代码的难度。但有时，使用协议又可以极大地简化代码。这需要不断在编 码中积累经验，才能 (在复杂度和表意上) 找到平衡。

## 协议和关联类型

有些协议需要约束的不仅仅是方法、属性和初始化方法，它们还希望和它相关的一些类型满足 特定的条件。这就可以通过关联类型 (associated type) 来实现。

## 类型消除器

尽管我们无法为带有 Self 或关联类型约束的协议创建存在体，但我们可以编写一个执行类似功 能的函数，叫做：类型消除器 (type erasers)。
